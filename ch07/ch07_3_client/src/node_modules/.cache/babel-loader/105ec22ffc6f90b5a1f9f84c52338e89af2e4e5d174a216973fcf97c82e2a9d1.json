{"ast":null,"code":"var _jsxFileName = \"C:\\\\rcp\\\\ch06\\\\ch06_2\\\\src\\\\components\\\\ListDraggable.tsx\",\n  _s = $RefreshSig$();\nimport { useRef } from \"react\";\nimport { useDrag, useDrop } from \"react-dnd\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nexport const ListDraggable = ({\n  id,\n  index,\n  onMove,\n  style,\n  className,\n  ...props\n}) => {\n  _s();\n  const ref = useRef(null);\n  const [{\n    handlerId\n  }, drop] = useDrop({\n    accept: \"list\",\n    collect(monitor) {\n      return {\n        handlerId: monitor.getHandlerId()\n      };\n    },\n    hover(item) {\n      if (!ref.current) {\n        return;\n      }\n      const dragIndex = item.index;\n      const hoverIndex = index;\n      if (dragIndex === hoverIndex) {\n        return;\n      }\n      onMove(dragIndex, hoverIndex);\n      item.index = hoverIndex;\n    }\n  });\n  const [{\n    isDragging\n  }, drag] = useDrag({\n    type: \"list\",\n    item: () => {\n      return {\n        id,\n        index\n      };\n    },\n    collect: monitor => ({\n      isDragging: monitor.isDragging\n    })\n  });\n  const opacity = isDragging ? 0 : 1;\n  drag(drop(ref));\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    ref: ref,\n    ...props,\n    className: [className, \"cursor-move\"].join(\" \"),\n    style: {\n      ...style,\n      opacity\n    },\n    \"data-handler-id\": handlerId\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 62,\n    columnNumber: 5\n  }, this);\n};\n_s(ListDraggable, \"Qm3J2iS1kJow3QPxw5bk8iZMsrM=\", false, function () {\n  return [useDrop, useDrag];\n});\n_c = ListDraggable;\nvar _c;\n$RefreshReg$(_c, \"ListDraggable\");","map":{"version":3,"names":["useRef","useDrag","useDrop","jsxDEV","_jsxDEV","ListDraggable","id","index","onMove","style","className","props","_s","ref","handlerId","drop","accept","collect","monitor","getHandlerId","hover","item","current","dragIndex","hoverIndex","isDragging","drag","type","opacity","join","fileName","_jsxFileName","lineNumber","columnNumber","_c","$RefreshReg$"],"sources":["C:/rcp/ch06/ch06_2/src/components/ListDraggable.tsx"],"sourcesContent":["import type {FC} from \"react\"\r\nimport {useRef} from \"react\"\r\nimport type {DivProps} from \"./Div\"\r\nimport {useDrag, useDrop} from \"react-dnd\"\r\nimport type {Identifier} from \"dnd-core\"\r\n\r\nexport type MoveFunc = (dragIndex: number, hoverIndex: number) => void\r\n\r\nexport type ListDraggableProps = DivProps & {\r\n  id: any\r\n  index: number\r\n  onMove: MoveFunc\r\n}\r\ninterface DragItem {\r\n  index: number\r\n  id: string\r\n  type: string\r\n}\r\nexport const ListDraggable: FC<ListDraggableProps> = ({\r\n  id,\r\n  index,\r\n  onMove,\r\n  style,\r\n  className,\r\n  ...props\r\n}) => {\r\n  const ref = useRef<HTMLDivElement>(null)\r\n  const [{handlerId}, drop] = useDrop<DragItem, void, {handlerId: Identifier | null}>({\r\n    accept: \"list\",\r\n    collect(monitor) {\r\n      return {\r\n        handlerId: monitor.getHandlerId()\r\n      }\r\n    },\r\n    hover(item: DragItem) {\r\n      if (!ref.current) {\r\n        return\r\n      }\r\n      const dragIndex = item.index\r\n      const hoverIndex = index\r\n\r\n      if (dragIndex === hoverIndex) {\r\n        return\r\n      }\r\n      onMove(dragIndex, hoverIndex)\r\n      item.index = hoverIndex\r\n    }\r\n  })\r\n\r\n  const [{isDragging}, drag] = useDrag({\r\n    type: \"list\",\r\n    item: () => {\r\n      return {id, index}\r\n    },\r\n    collect: (monitor: any) => ({\r\n      isDragging: monitor.isDragging\r\n    })\r\n  })\r\n  const opacity = isDragging ? 0 : 1\r\n  drag(drop(ref))\r\n  return (\r\n    <div\r\n      ref={ref}\r\n      {...props}\r\n      className={[className, \"cursor-move\"].join(\" \")}\r\n      style={{...style, opacity}}\r\n      data-handler-id={handlerId}\r\n    />\r\n  )\r\n}\r\n"],"mappings":";;AACA,SAAQA,MAAM,QAAO,OAAO;AAE5B,SAAQC,OAAO,EAAEC,OAAO,QAAO,WAAW;AAAA,SAAAC,MAAA,IAAAC,OAAA;AAe1C,OAAO,MAAMC,aAAqC,GAAGA,CAAC;EACpDC,EAAE;EACFC,KAAK;EACLC,MAAM;EACNC,KAAK;EACLC,SAAS;EACT,GAAGC;AACL,CAAC,KAAK;EAAAC,EAAA;EACJ,MAAMC,GAAG,GAAGb,MAAM,CAAiB,IAAI,CAAC;EACxC,MAAM,CAAC;IAACc;EAAS,CAAC,EAAEC,IAAI,CAAC,GAAGb,OAAO,CAAiD;IAClFc,MAAM,EAAE,MAAM;IACdC,OAAOA,CAACC,OAAO,EAAE;MACf,OAAO;QACLJ,SAAS,EAAEI,OAAO,CAACC,YAAY,CAAC;MAClC,CAAC;IACH,CAAC;IACDC,KAAKA,CAACC,IAAc,EAAE;MACpB,IAAI,CAACR,GAAG,CAACS,OAAO,EAAE;QAChB;MACF;MACA,MAAMC,SAAS,GAAGF,IAAI,CAACd,KAAK;MAC5B,MAAMiB,UAAU,GAAGjB,KAAK;MAExB,IAAIgB,SAAS,KAAKC,UAAU,EAAE;QAC5B;MACF;MACAhB,MAAM,CAACe,SAAS,EAAEC,UAAU,CAAC;MAC7BH,IAAI,CAACd,KAAK,GAAGiB,UAAU;IACzB;EACF,CAAC,CAAC;EAEF,MAAM,CAAC;IAACC;EAAU,CAAC,EAAEC,IAAI,CAAC,GAAGzB,OAAO,CAAC;IACnC0B,IAAI,EAAE,MAAM;IACZN,IAAI,EAAEA,CAAA,KAAM;MACV,OAAO;QAACf,EAAE;QAAEC;MAAK,CAAC;IACpB,CAAC;IACDU,OAAO,EAAGC,OAAY,KAAM;MAC1BO,UAAU,EAAEP,OAAO,CAACO;IACtB,CAAC;EACH,CAAC,CAAC;EACF,MAAMG,OAAO,GAAGH,UAAU,GAAG,CAAC,GAAG,CAAC;EAClCC,IAAI,CAACX,IAAI,CAACF,GAAG,CAAC,CAAC;EACf,oBACET,OAAA;IACES,GAAG,EAAEA,GAAI;IAAA,GACLF,KAAK;IACTD,SAAS,EAAE,CAACA,SAAS,EAAE,aAAa,CAAC,CAACmB,IAAI,CAAC,GAAG,CAAE;IAChDpB,KAAK,EAAE;MAAC,GAAGA,KAAK;MAAEmB;IAAO,CAAE;IAC3B,mBAAiBd;EAAU;IAAAgB,QAAA,EAAAC,YAAA;IAAAC,UAAA;IAAAC,YAAA;EAAA,OAC5B,CAAC;AAEN,CAAC;AAAArB,EAAA,CAnDYP,aAAqC;EAAA,QASpBH,OAAO,EAsBND,OAAO;AAAA;AAAAiC,EAAA,GA/BzB7B,aAAqC;AAAA,IAAA6B,EAAA;AAAAC,YAAA,CAAAD,EAAA","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}